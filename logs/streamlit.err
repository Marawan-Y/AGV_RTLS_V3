2025-09-03 13:52:08.267 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 13, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:52:24.378 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 9, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:52:25.678 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 10, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:52:26.835 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\03_live_monitor.py", line 12, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:52:27.276 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 11, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:52:27.857 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 11, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:52:28.434 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 13, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:53:14.376 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 13, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:53:16.172 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 13, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:53:17.356 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 335, in connection
    con = self._idle_cache.pop(0)
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 13, in <module>
    from src.core.database import db_manager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\__init__.py", line 3, in <module>
    from .database import db_manager, DatabaseManager
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 267, in <module>
    db_manager = DatabaseManager()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 27, in __init__
    self.sync_pool = self._create_sync_pool()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 48, in _create_sync_pool
    return PooledDB(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in __init__
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 282, in <listcomp>
    idle = [self.dedicated_connection() for i in range(mincached)]
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 346, in dedicated_connection
    return self.connection(False)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 337, in connection
    con = self.steady_connection()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\pooled_db.py", line 288, in steady_connection
    return connect(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 138, in connect
    return SteadyDBConnection(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 197, in __init__
    self._store(self._create())
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\dbutils\steady_db.py", line 215, in _create
    con = self._creator(*self._args, **self._kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 267, in caching_sha2_password_auth
    data = sha2_rsa_encrypt(conn.password, conn.salt, conn.server_public_key)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-09-03 13:54:03.985 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-03 13:54:04.897 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 14, in <module>
    from src.analytics.trajectory_analyzer import TrajectoryAnalyzer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\__init__.py", line 3, in <module>
    from .trajectory_analyzer import TrajectoryAnalyzer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\trajectory_analyzer.py", line 11, in <module>
    import networkx as nx
ModuleNotFoundError: No module named 'networkx'
2025-09-03 13:55:15.583 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-03 13:55:18.261 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 14, in <module>
    from src.analytics.trajectory_analyzer import TrajectoryAnalyzer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\__init__.py", line 4, in <module>
    from .heatmap_generator import HeatmapGenerator
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\heatmap_generator.py", line 10, in <module>
    import datashader as ds
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\datashader\__init__.py", line 14, in <module>
    from . import data_libraries                             # noqa (API import)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\datashader\data_libraries\__init__.py", line 5, in <module>
    from . import dask    # noqa (API import)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\datashader\data_libraries\dask.py", line 55, in <module>
    bypixel.pipeline.register(dd.core.DataFrame)(dask_pipeline)
AttributeError: module 'dask.dataframe.core' has no attribute 'DataFrame'
2025-09-03 14:14:48.369 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-03 14:14:56.845 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 51, in <module>
    class AGVDashboard:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 62, in AGVDashboard
    def _load_plant_map(self) -> Optional[Image.Image]:
NameError: name 'Optional' is not defined
2025-09-03 14:16:45.957 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 62, in __init__
    self.plant_map = self._load_plant_map()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 69, in _load_plant_map
    return Image.open(map_path)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\PIL\Image.py", line 3580, in open
    raise UnidentifiedImageError(msg)
PIL.UnidentifiedImageError: cannot identify image file 'assets\\plant_map.png'
2025-09-03 14:17:11.267 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    fleet_status = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 14:17:47.231 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 12, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:19:28.564 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 13, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:19:59.195 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:20:01.312 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:20:02.793 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 14, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:20:03.333 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:20:04.285 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 14, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:20:05.054 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:20:11.969 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:23:11.712 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-03 14:23:25.294 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    fleet_status = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 14:27:13.793 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:28:20.098 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:28:23.309 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\01_agv_tracker.py", line 15, in <module>
    from src.dashboard.components.map_renderer import MapRenderer
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 16, in <module>
    class MapRenderer:
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\components\map_renderer.py", line 330, in MapRenderer
    timestamps: List[datetime]) -> go.Figure:
NameError: name 'datetime' is not defined
2025-09-03 14:28:32.768 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 14:28:55.974 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 14:28:56.000 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 80, in render_page
    fleet_stats = performance_metrics.get_fleet_stats(end_time - start_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    fleet_status = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 14:28:59.440 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 14:29:06.444 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 14:29:06.463 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 102, in render_page
    zone_stats = zone_analytics.get_zone_statistics(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 43, in get_zone_statistics
    stats = db_manager.query_dataframe(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 14:29:15.289 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 87, in render_page
    kpis = performance_metrics.calculate_kpis(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 118, in calculate_kpis
    efficiency = self._calculate_efficiency(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 145, in _calculate_efficiency
    result = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 14:29:18.428 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    fleet_status = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 14:33:09.613 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 14:33:11.679 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 14:37:40.109 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 14:37:42.099 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:26:19.804 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:26:25.108 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:26:25.142 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 80, in render_page
    fleet_stats = performance_metrics.get_fleet_stats(end_time - start_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:26:34.735 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:26:44.785 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:26:44.965 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 102, in render_page
    zone_stats = zone_analytics.get_zone_statistics(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 43, in get_zone_statistics
    stats = db_manager.query_dataframe(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 15:26:55.826 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 87, in render_page
    kpis = performance_metrics.calculate_kpis(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 118, in calculate_kpis
    "system_health": self._calculate_system_health(fleet_status),
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 145, in _calculate_efficiency
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 15:31:46.637 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:31:59.380 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:32:00.039 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:32:00.062 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 80, in render_page
    fleet_stats = performance_metrics.get_fleet_stats(end_time - start_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:32:16.970 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:32:34.782 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:32:56.999 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:32:58.916 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:32:58.943 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 80, in render_page
    fleet_stats = performance_metrics.get_fleet_stats(end_time - start_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:33:06.840 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:33:06.868 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 102, in render_page
    zone_stats = zone_analytics.get_zone_statistics(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 43, in get_zone_statistics
    stats = db_manager.query_dataframe(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 15:33:20.591 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 87, in render_page
    kpis = performance_metrics.calculate_kpis(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 118, in calculate_kpis
    "system_health": self._calculate_system_health(fleet_status),
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 145, in _calculate_efficiency
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 15:40:49.507 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 87, in render_page
    kpis = performance_metrics.calculate_kpis(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 118, in calculate_kpis
    "system_health": self._calculate_system_health(fleet_status),
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 145, in _calculate_efficiency
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 15:40:50.656 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:40:51.077 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:40:52.934 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:40:55.427 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:40:55.889 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:40:55.909 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 80, in render_page
    fleet_stats = performance_metrics.get_fleet_stats(end_time - start_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:40:56.302 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:40:56.678 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:40:56.693 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 102, in render_page
    zone_stats = zone_analytics.get_zone_statistics(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 43, in get_zone_statistics
    # Use stored procedure
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-09-03 15:40:57.713 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 15:40:57.984 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:43:47.533 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    params = tuple(params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:43:48.699 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    params = tuple(params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 15:43:49.639 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    params = tuple(params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:03:11.702 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 672, in run
    self.render_header_metrics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 164, in render_header_metrics
    stats = self.performance_metrics.get_fleet_stats()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 39, in get_fleet_stats
    # - Replace Postgres DISTINCT ON with a max(ts) self-join
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 173, in query_dataframe
    params = tuple(params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id) \n                    agv_id, speed_mps, battery_percent\n            ' at line 11")
[SQL: 
            SELECT 
                r.agv_id,
                r.status,
                r.type,
                r.total_distance_km,
                r.total_runtime_hours,
                COALESCE(p.speed_mps, 0) as current_speed,
                COALESCE(p.battery_percent, 100) as battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id) 
                    agv_id, speed_mps, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '1 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:03:32.756 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-03 16:03:41.337 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:03:41.339 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:03:53.560 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:03:55.952 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:03:55.955 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:03:55.958 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 29, in <module>
    zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:03:58.119 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:03:58.131 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:04:00.138 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:04:00.142 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:04:00.144 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\04_zone_analysis.py", line 28, in <module>
    zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:04:00.849 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:04:00.851 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 87, in render_page
    kpis = performance_metrics.calculate_kpis(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 141, in calculate_kpis
    efficiency = self._calculate_efficiency(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 169, in _calculate_efficiency
    result = db_manager.query_dataframe(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql(text(query), conn, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:04:03.145 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:22.814 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:22.817 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 87, in render_page
    kpis = performance_metrics.calculate_kpis(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 141, in calculate_kpis
    efficiency = self._calculate_efficiency(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 169, in _calculate_efficiency
    result = db_manager.query_dataframe(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:25.691 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:25.694 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 87, in render_page
    kpis = performance_metrics.calculate_kpis(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 141, in calculate_kpis
    efficiency = self._calculate_efficiency(start_time, end_time)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\performance_metrics.py", line 169, in _calculate_efficiency
    result = db_manager.query_dataframe(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:27.766 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:27.769 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.118 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.120 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.367 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.368 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.583 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.585 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.815 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:29.817 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:30.046 | ERROR    | src.core.database:get_connection:120 - Database error: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:30.048 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 708, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2728, in read_query
    cursor = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 2660, in execute
    raise TypeError("Query must be a string unless using sqlalchemy.")
TypeError: Query must be a string unless using sqlalchemy.
2025-09-03 16:09:45.736 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-03 16:09:53.547 | ERROR    | src.core.database:get_connection:120 - Database error: 'DatabaseManager' object has no attribute '_engine'
2025-09-03 16:09:53.548 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self._engine, params=params)
AttributeError: 'DatabaseManager' object has no attribute '_engine'. Did you mean: 'engine'?
2025-09-03 16:13:54.393 | ERROR    | src.core.database:get_connection:120 - Database error: 'DatabaseManager' object has no attribute '_engine'
2025-09-03 16:13:54.396 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
AttributeError: 'DatabaseManager' object has no attribute '_engine'. Did you mean: 'engine'?
2025-09-03 16:13:56.414 | ERROR    | src.core.database:get_connection:120 - Database error: 'DatabaseManager' object has no attribute '_engine'
2025-09-03 16:13:56.417 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
AttributeError: 'DatabaseManager' object has no attribute '_engine'. Did you mean: 'engine'?
2025-09-03 16:14:07.810 | ERROR    | src.core.database:get_connection:120 - Database error: 'DatabaseManager' object has no attribute '_engine'
2025-09-03 16:14:07.812 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 685, in main
    dashboard = AGVDashboard()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 60, in __init__
    self.zone_analytics = ZoneAnalytics()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 21, in __init__
    self.zones = self._load_zones()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\analytics\zone_analytics.py", line 26, in _load_zones
    return db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
AttributeError: 'DatabaseManager' object has no attribute '_engine'. Did you mean: 'engine'?
2025-09-03 16:14:23.535 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-03 16:14:28.079 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 27, 627819), 'end': datetime.datetime(2025, 9, 3, 16, 14, 27, 629819)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:14:28.083 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 676, in run
    self.render_analytics_section(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 400, in render_analytics_section
    self.render_anomaly_detection(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 595, in render_anomaly_detection
    anomalies = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 528, in read_sql_query
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 27, 627819), 'end': datetime.datetime(2025, 9, 3, 16, 14, 27, 629819)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:14:43.219 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:14:44.966 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:14:45.017 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")
[SQL: 
            SELECT 
                status,
                COUNT(*) as count,
                AVG(battery_percent) as avg_battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id)
                    agv_id, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '5 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
            GROUP BY status
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:14:45.020 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 178, in render_page
    fleet_status = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 528, in read_sql_query
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")
[SQL: 
            SELECT 
                status,
                COUNT(*) as count,
                AVG(battery_percent) as avg_battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id)
                    agv_id, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '5 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
            GROUP BY status
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:14:56.710 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 56, 319289), 'end': datetime.datetime(2025, 9, 3, 16, 14, 56, 323806)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:14:56.711 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 676, in run
    self.render_analytics_section(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 400, in render_analytics_section
    self.render_anomaly_detection(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 595, in render_anomaly_detection
    anomalies = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 528, in read_sql_query
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 56, 319289), 'end': datetime.datetime(2025, 9, 3, 16, 14, 56, 323806)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:14:58.069 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:14:58.084 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:14:59.699 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:15:01.647 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:15:03.103 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:15:03.709 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 3, 336896), 'end': datetime.datetime(2025, 9, 3, 16, 15, 3, 337897)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:15:03.710 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 676, in run
    self.render_analytics_section(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 400, in render_analytics_section
    self.render_anomaly_detection(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 595, in render_anomaly_detection
    anomalies = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 528, in read_sql_query
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 3, 336896), 'end': datetime.datetime(2025, 9, 3, 16, 15, 3, 337897)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:15:04.116 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:15:04.129 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:15:05.531 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 5, 189036), 'end': datetime.datetime(2025, 9, 3, 16, 15, 5, 191120)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:15:05.531 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 689, in <module>
    main()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 686, in main
    dashboard.run()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 676, in run
    self.render_analytics_section(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 400, in render_analytics_section
    self.render_anomaly_detection(filters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\app.py", line 595, in render_anomaly_detection
    anomalies = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 528, in read_sql_query
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':start AND :end\n            AND event_type = 'ANOMALY_DETECTED'\n            ORDE' at line 9")
[SQL: 
            SELECT 
                event_type,
                severity,
                agv_id,
                zone_id,
                message,
                created_at
            FROM system_events
            WHERE created_at BETWEEN :start AND :end
            AND event_type = 'ANOMALY_DETECTED'
            ORDER BY created_at DESC
            LIMIT 100
        ]
[parameters: {'start': datetime.datetime(2025, 9, 3, 0, 0, 5, 189036), 'end': datetime.datetime(2025, 9, 3, 16, 15, 5, 191120)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:15:09.143 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:20:13.467 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:20:15.112 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:20:15.161 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")
[SQL: 
            SELECT 
                status,
                COUNT(*) as count,
                AVG(battery_percent) as avg_battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id)
                    agv_id, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '5 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
            GROUP BY status
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:20:15.163 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 178, in render_page
    fleet_status = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 528, in read_sql_query
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")
[SQL: 
            SELECT 
                status,
                COUNT(*) as count,
                AVG(battery_percent) as avg_battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id)
                    agv_id, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '5 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
            GROUP BY status
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:20:18.861 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:20:18.912 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")
[SQL: 
            SELECT 
                status,
                COUNT(*) as count,
                AVG(battery_percent) as avg_battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id)
                    agv_id, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '5 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
            GROUP BY status
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:20:18.914 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 556, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\02_fleet_analytics.py", line 178, in render_page
    fleet_status = db_manager.query_dataframe("""
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\core\database.py", line 175, in query_dataframe
    return pd.read_sql_query(sql=query, con=self.engine, params=params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 528, in read_sql_query
    return pandas_sql.read_query(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON (agv_id)\n                    agv_id, battery_percent\n                FROM agv' at line 7")
[SQL: 
            SELECT 
                status,
                COUNT(*) as count,
                AVG(battery_percent) as avg_battery
            FROM agv_registry r
            LEFT JOIN (
                SELECT DISTINCT ON (agv_id)
                    agv_id, battery_percent
                FROM agv_positions
                WHERE ts >= NOW() - INTERVAL '5 minute'
                ORDER BY agv_id, ts DESC
            ) p ON r.agv_id = p.agv_id
            GROUP BY status
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:21:19.390 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:21:19.403 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:21:24.420 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:21:29.428 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:21:34.438 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:21:35.018 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:21:39.448 | ERROR    | src.core.database:get_connection:120 - Database error: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY agv_id\n                ) last ON p1.agv_id = last.agv_id AND last.max_t' at line 18")
[SQL: 
                SELECT DISTINCT p.agv_id,
                    p1.agv_id,
                    p1.ts,
                    p1.plant_x,
                    p1.plant_y,
                    p1.heading_deg,
                    p1.speed_mps,
                    p1.zone_id,
                    p1.battery_percent,
                    p1.status,
                    r.display_name,
                    r.type
                FROM agv_positions p1
                JOIN (
                    SELECT agv_id, MAX(ts) AS max_ts
                    FROM agv_positions
                    WHERE ts >= NOW() - INTERVAL '10 second'
                    GROUP BY agv_id
                ) last ON p1.agv_id = last.agv_id AND last.max_ts = p1.ts
                JOIN agv_registry r ON p1.agv_id = r.agv_id                                         
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-03 16:21:43.299 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 502, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 158, in render_page
    render_efficiency_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 237, in render_efficiency_kpis
    f"{efficiency_data['motion_efficiency'].iloc[0]:.1f}%",
TypeError: unsupported format string passed to NoneType.__format__
2025-09-03 16:31:35.899 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:46:32.607 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:46:33.251 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:46:37.934 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-03 16:46:38.736 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:46:40.909 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-03 16:46:44.356 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 07:56:56.529 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 07:57:46.577 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 07:57:50.995 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 07:58:02.052 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 07:58:17.075 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 07:58:21.622 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 07:58:53.142 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 07:58:57.734 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 11:04:50.243 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 11:04:51.885 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 11:04:55.722 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 11:05:28.128 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 11:05:31.269 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 12:33:43.016 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 12:33:51.468 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 12:33:52.072 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 12:33:52.815 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 12:33:53.963 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 12:33:54.936 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 12:33:55.690 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 12:34:04.396 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 12:34:05.440 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 446, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 12:34:21.862 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 461, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 12:34:46.596 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 12:35:12.582 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 12:35:30.592 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 461, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 13:30:59.725 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 13:31:24.172 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:31:26.991 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:31:32.620 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:31:38.478 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:31:46.912 Uncaught app exception
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 461, in <module>
    render_page()
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 163, in render_page
    render_productivity_kpis(start_time, end_time, enable_comparison)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\src\dashboard\pages\05_performance_kpi.py", line 298, in render_productivity_kpis
    completed_tasks = int(productivity_data['completed_tasks'].iloc[0]) if not productivity_data.empty else 0
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-09-08 13:32:26.231 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:34:11.480 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:34:27.700 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:34:32.918 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:34:38.113 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:34:40.500 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:43:26.769 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 13:43:42.520 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:44:00.628 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:44:02.993 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:44:09.463 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:44:10.835 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:44:15.212 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:49:07.634 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:49:09.566 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:49:10.248 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 13:49:11.218 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 14:06:15.232 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 14:06:40.751 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 14:12:51.611 Uncaught exception GET /_stcore/stream (127.0.0.1)
HTTPServerRequest(protocol='http', host='127.0.0.1:8501', method='GET', uri='/_stcore/stream', version='HTTP/1.1', remote_ip='127.0.0.1')
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 659, in _run_callback
    result = callback(*args, **kwargs)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\web\server\browser_websocket_handler.py", line 196, in on_message
    self._runtime.handle_backmsg(self._session_id, msg)
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\streamlit\runtime\runtime.py", line 490, in handle_backmsg
    raise RuntimeStoppedError(f"Can't handle_backmsg (state={self._state})")
streamlit.runtime.runtime.RuntimeStoppedError: Can't handle_backmsg (state=RuntimeState.STOPPED)
2025-09-08 14:12:51.899 503 GET /_stcore/health (127.0.0.1) 21.57ms
2025-09-08 14:13:13.143 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 14:13:22.425 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 14:52:57.280 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 14:53:17.554 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 14:53:22.866 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 14:53:31.639 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:00:15.919 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 15:00:32.141 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:24:38.461 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:26:44.172 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 15:27:01.825 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:27:36.571 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:28:04.516 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
Task exception was never retrieved
future: <Task finished name='Task-390' coro=<WebSocketProtocol13.write_message.<locals>.wrapper() done, defined at C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py:1111> exception=WebSocketClosedError()>
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1113, in wrapper
    await fut
tornado.iostream.StreamClosedError: Stream is closed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1115, in wrapper
    raise WebSocketClosedError()
tornado.websocket.WebSocketClosedError
Task exception was never retrieved
future: <Task finished name='Task-391' coro=<WebSocketProtocol13.write_message.<locals>.wrapper() done, defined at C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py:1111> exception=WebSocketClosedError()>
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1113, in wrapper
    await fut
tornado.iostream.StreamClosedError: Stream is closed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1115, in wrapper
    raise WebSocketClosedError()
tornado.websocket.WebSocketClosedError
Task exception was never retrieved
future: <Task finished name='Task-392' coro=<WebSocketProtocol13.write_message.<locals>.wrapper() done, defined at C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py:1111> exception=WebSocketClosedError()>
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1113, in wrapper
    await fut
tornado.iostream.StreamClosedError: Stream is closed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1115, in wrapper
    raise WebSocketClosedError()
tornado.websocket.WebSocketClosedError
Task exception was never retrieved
future: <Task finished name='Task-395' coro=<WebSocketProtocol13.write_message.<locals>.wrapper() done, defined at C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py:1111> exception=WebSocketClosedError()>
Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1113, in wrapper
    await fut
tornado.iostream.StreamClosedError: Stream is closed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\20030497\Desktop\AGV RTLS\AGV_RTLS_V3\venv\lib\site-packages\tornado\websocket.py", line 1115, in wrapper
    raise WebSocketClosedError()
tornado.websocket.WebSocketClosedError
2025-09-08 15:28:30.704 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:35:23.464 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 15:35:33.650 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:35:40.975 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:35:49.244 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:35:57.237 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:39:55.123 | INFO     | src.core.database:_init_checks:95 - Connected to MySQL 8.0.43
2025-09-08 15:40:15.529 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:40:27.914 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
2025-09-08 15:40:37.370 | INFO     | src.core.zone_manager:load_zones:58 - Loaded 0 zones
